<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.avg.lawsuitmanagement.token.repository.TokenMapperRepository">

    <select id = "selectClientByEmail" parameterType="java.lang.String"
      resultType="ClientDto">
        select * from client where email = #{email} and is_deleted = false
    </select>

    <insert id="insertClient" parameterType="ClientSignUpParam">
        insert into client(email, password, name, phone, address)
        values (#{email}, #{password}, #{name}, #{phone}, #{address})
    </insert>

    <select id = "selectEmployeeById" parameterType="java.lang.String"
        resultType="EmployeeDto">
        SELECT e.*, h.name AS hierarchy_name, r.name AS role_name
        FROM employee e
                 JOIN hierarchy h ON e.hierarchy_id = h.id
                 JOIN role r ON e.role_id = r.id
        WHERE e.email = #{email} and e.is_deleted = false
    </select>

    <insert id="insertEmployee" parameterType="EmployeeSignUpParam">
        insert into employee (email, password, name, phone, hierarchy_id, address, role_id)
        values (#{email}, #{password}, #{name}, #{phone}, #{hierarchyId}, #{address}, #{roleId})
    </insert>
</mapper>